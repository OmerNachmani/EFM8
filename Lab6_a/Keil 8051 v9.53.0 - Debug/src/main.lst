C51 COMPILER V9.60.0.0   MAIN                                                              01/02/2026 11:46:53 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\src/main.OBJ
COMPILER INVOKED BY: Z:\home\onachman\SimplicityStudio5\SimplicityStudio_v5\developer\toolchains\keil_8051\9.60\BIN\C51 
                    -/home/onachman/SimplicityStudio/v5_workspace/Lab6_a/src/main.c OMF2 SMALL DEBUG OBJECTEXTEND ROM(LARGE) WARNINGLEVEL(2) 
                    -FLOATFUZZY(3) OPTIMIZE(8,SPEED) INTVECTOR(0X0000) INTPROMOTE INCDIR(/home/onachman/SimplicityStudio/v5_workspace/Lab6_a/
                    -inc;/home/onachman/SimplicityStudio/v5_workspace/Lab6_a/inc/config;/home/onachman/SimplicityStudio5/SimplicityStudio_v5/
                    -developer/sdks/8051/v4.3.1//kits/common/drivers/efm8_memory_lcd/inc;/home/onachman/SimplicityStudio5/SimplicityStudio_v5
                    -/developer/sdks/8051/v4.3.1//kits/common/drivers/efm8_memory_lcd/inc/graphics;/home/onachman/SimplicityStudio5/Simplicit
                    -yStudio_v5/developer/sdks/8051/v4.3.1//kits/common/drivers/efm8_memory_lcd/inc/config;/home/onachman/SimplicityStudio5/S
                    -implicityStudio_v5/developer/sdks/8051/v4.3.1//kits/common/bsp;/home/onachman/SimplicityStudio5/SimplicityStudio_v5/deve
                    -loper/sdks/8051/v4.3.1//kits/EFM8UB2_SLSTK2001A/config;/home/onachman/SimplicityStudio5/SimplicityStudio_v5/developer/sd
                    -ks/8051/v4.3.1//Device/shared/si8051Base;/home/onachman/SimplicityStudio5/SimplicityStudio_v5/developer/sdks/8051/v4.3.1
                    -//Device/EFM8UB2/inc;/home/onachman/SimplicityStudio5/SimplicityStudio_v5/developer/sdks/8051/v4.3.1//kits/common/driver
                    -s/efm8_joystick;/home/onachman/SimplicityStudio5/SimplicityStudio_v5/developer/sdks/8051/v4.3.1//kits/common/drivers/efm
                    -8_rgb_led;/home/onachman/SimplicityStudio5/SimplicityStudio_v5/developer/sdks/8051/v4.3.1//Device/EFM8UB2/peripheral_dri
                    -ver/inc) PRINT(.\src/main.lst) COND PAGEWIDTH(120) PAGELENGTH(65) OBJECT(.\src/main.OBJ)

line level    source

   1          #include <SI_EFM8UB2_Register_Enums.h>
   2          #include "InitDevice.h"
   3          #include "tick.h"
   4          #include <stdint.h>
   5          
   6          // Direction Pin Definitions (Slide 12)
   7          SI_SBIT(M1, SFR_P0, 4);   // EFM8 P0.4 -> L293D Input 1
   8          SI_SBIT(M2, SFR_P0, 5);   // EFM8 P0.5 -> L293D Input 2
   9          
  10          // Button Definitions
  11          SI_SBIT(BTN0, SFR_P0, 2); // PB0: Spin Direction A
  12          SI_SBIT(BTN1, SFR_P0, 3); // PB1: Spin Direction B
  13          
  14          // PWM Speed Constants (8-bit PWM)
  15          #define SPEED_MAX   0     // 100% Duty Cycle (PCA0CPH0 = 0)
  16          #define SPEED_MIN   255   // 0% Duty Cycle (PCA0CPH0 = 255)
  17          #define SPEED_STEP  25
  18          
  19          void Set_Motor_Speed(uint8_t duty) {
  20   1          PCA0CPH0 = duty;      // Adjusts the PWM duty cycle on P0.1
  21   1      }
  22          
  23          void main(void) {
  24   1          uint8_t current_speed = 128; // Start at 50% speed
  25   1      
  26   1          enter_DefaultMode_from_RESET();
  27   1          IE_EA = 1;
  28   1      
  29   1          // Configure PCA0 for 8-bit PWM mode on P0.1
  30   1          // PCA0CPM0: PWM16=0, ECOM=1, CAPP=0, CAPN=0, MAT=0, TOG=0, PWM=1, ECCF=0
  31   1          PCA0CPM0 = 0x42;
  32   1      
  33   1          // Initial State: Stopped
  34   1          M1 = 0;
  35   1          M2 = 0;
  36   1          Set_Motor_Speed(current_speed);
  37   1      
  38   1          while (1) {
  39   2              // --- Direction Control (Buttons) ---
  40   2              if (BTN0 == 0) {       // PB0 pressed: Spin Right
  41   3                  M1 = 1;
  42   3                  M2 = 0;
  43   3                  Wait(100);
C51 COMPILER V9.60.0.0   MAIN                                                              01/02/2026 11:46:53 PAGE 2   

  44   3              }
  45   2              if (BTN1 == 0) {       // PB1 pressed: Spin Left
  46   3                  M1 = 0;
  47   3                  M2 = 1;
  48   3                  Wait(100);
  49   3              }
  50   2      
  51   2              // --- Speed Control (Joystick/Logic) ---
  52   2              // Note: You mentioned Joystick right/left for speed.
  53   2              // If the joystick uses ADC, you would read the ADC value here.
  54   2              // For now, we will use your existing button logic logic to simulate speed steps:
  55   2      
  56   2              /* Example logic if using digital inputs for Joystick:
  57   2              if (JOY_RIGHT == 0 && current_speed > SPEED_MAX) {
  58   2                  current_speed -= SPEED_STEP;
  59   2                  Set_Motor_Speed(current_speed);
  60   2                  Wait(200);
  61   2              }
  62   2              */
  63   2      
  64   2              Set_Motor_Speed(current_speed);
  65   2          }
  66   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     58    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
